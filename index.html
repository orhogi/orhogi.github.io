<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>cote.my — Instagram Redirector</title>
  <style>
    :root{--bg:#fff;--fg:#111;--muted:#666}
    html,body{height:100%}
    body{margin:0;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,#f8fafc,#fff);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;color:var(--fg)}
    .card{max-width:720px;padding:28px;border-radius:12px;box-shadow:0 6px 24px rgba(16,24,40,.08);background:rgba(255,255,255,.9);text-align:center}
    h1{margin:0 0 8px;font-size:18px}
    p{margin:0 0 14px;color:var(--muted)}
    .link{word-break:break-all;background:#f3f4f6;padding:10px;border-radius:8px;margin:12px 0}
    a.button{display:inline-block;padding:10px 16px;border-radius:9px;background:#0b69ff;color:#fff;text-decoration:none}
    small{display:block;margin-top:10px;color:var(--muted)}
  </style>
</head>
<body>
  <div class="card" id="card">
    <h1 id="title">Redirecting…</h1>
    <p id="desc">Preparing clean Instagram link for you.</p>

    <div id="linkbox" class="link" style="display:none"></div>
    <a id="manual" class="button" href="#" style="display:none">Go to destination</a>
    <small id="note">If you are not redirected automatically, click the button above.</small>
  </div>

<script>
(function(){
  // Get the path, removing leading/trailing slashes and normalizing internal slashes
  // Example: /reel//DQRQJwkfIi/ -> reel/DQRQJwkfIi
  const rawPath = window.location.pathname;
  const queryString = window.location.search; // Includes '?' if present

  const path = rawPath
    .replace(/\/+/g, '/') // Replace multiple slashes with one
    .replace(/^\/|\/$/g, ''); // Remove single leading/trailing slashes

  const titleEl = document.getElementById('title');
  const descEl = document.getElementById('desc');
  const noteEl = document.getElementById('note');
  const linkboxEl = document.getElementById('linkbox');
  const manualEl = document.getElementById('manual');

  // --- 1. Handle Root/Info Page ---
  if (!path || path === '') {
    titleEl.innerText = 'cote.my — Instagram Link Shortener';
    descEl.innerText = 'Usage examples: /reel/<id>/ , /p/<id>/ , /user/<username>/';
    noteEl.innerText = 'This file must be configured as the catch-all/404 page for the redirect to function.';
    return;
  }

  // --- 2. Build Target URL ---
  // Target format: https://www.instagram.com/[normalized_path]/[?query_string]
  const target = `https://www.instagram.com/${path}/${queryString}`;

  // --- 3. Update UI for Manual Fallback ---
  linkboxEl.style.display = 'block';
  linkboxEl.textContent = target;

  manualEl.href = target;
  manualEl.style.display = 'inline-block';

  // --- 4. Perform Automatic Redirect ---
  // Use replace() to prevent the redirect page from cluttering the browser history.
  setTimeout(() => {
    try {
      window.location.replace(target);
    } catch (e) {
      // Fallback: Ensure the manual button is visible if the automatic redirect fails.
      manualEl.style.display = 'inline-block';
    }
  }, 100); // Wait 100ms before redirecting
})();
</script>
</body>
</html>
